<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Smart Chatbot</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-button {
            background: #5a7c46;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #4a6b3a;
        }
        .test-results {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #5a7c46;
            background: white;
        }
        .test-input {
            font-weight: bold;
            color: #333;
        }
        .test-output {
            margin-top: 5px;
            color: #666;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß† Test Smart Chatbot</h1>
        <p>Ki·ªÉm tra chatbot th√¥ng minh h∆°n</p>
        
        <div id="status" class="status"></div>
        
        <div>
            <button class="test-button" onclick="runSmartTests()">Test Smart Responses</button>
            <button class="test-button" onclick="clearResults()">Clear Results</button>
        </div>
        
        <div class="test-results" id="test-results"></div>
    </div>

    <!-- Load Scripts -->
    <script src="script/chatbot-config.js"></script>
    <script src="script/dialogflow-loader.js"></script>
    <script src="script/chatbot.js"></script>

    <script>
        let chatbot = null;

        function updateStatus(message, type = 'success') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }

        function addTestResult(input, output, isSuccess) {
            const resultsDiv = document.getElementById('test-results');
            const testItem = document.createElement('div');
            testItem.className = 'test-item';
            
            testItem.innerHTML = `
                <div class="test-input">Input: "${input}"</div>
                <div class="test-output">Output: ${output}</div>
                <div style="color: ${isSuccess ? 'green' : 'red'}; font-weight: bold;">
                    ${isSuccess ? '‚úÖ Th√†nh c√¥ng' : '‚ùå Th·∫•t b·∫°i'}
                </div>
            `;
            
            resultsDiv.appendChild(testItem);
        }

        function clearResults() {
            document.getElementById('test-results').innerHTML = '';
        }

        function runSmartTests() {
            if (!chatbot) {
                updateStatus('‚ùå Chatbot ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o!', 'error');
                return;
            }

            clearResults();
            updateStatus('üß™ ƒêang ch·∫°y test...', 'success');

            const testCases = [
                'h√£y cho t√¥i c√°c s·∫£n ph·∫©m',
                't√¥i c·∫ßn s·∫£n ph·∫©m',
                'c√°c s·∫£n ph·∫©m',
                's·∫£n ph·∫©m',
                'd·ªãch v·ª•',
                'gi√° c·∫£',
                'giao h√†ng',
                'ƒë·ªãa ch·ªâ',
                'hotline',
                't∆∞ v·∫•n',
                'ƒë·∫∑t hoa',
                'hoa h·ªìng',
                'xin ch√†o',
                'c·∫£m ∆°n'
            ];

            let successCount = 0;
            let totalCount = testCases.length;

            testCases.forEach((testCase, index) => {
                setTimeout(() => {
                    try {
                        const responses = chatbot.getSmartResponses(testCase);
                        const response = responses && responses.length > 0 ? responses[0] : 'Kh√¥ng c√≥ ph·∫£n h·ªìi';
                        
                        // Check if response is meaningful (not generic)
                        const isGeneric = response.includes('H·∫° Mi√™n s·∫µn s√†ng h·ªó tr·ª£ b·∫°n') || 
                                        response.includes('B·∫°n c·∫ßn gi√∫p g√¨ ·∫°') ||
                                        response.length < 20;
                        
                        const isSuccess = !isGeneric && response.length > 20;
                        
                        if (isSuccess) successCount++;
                        
                        addTestResult(testCase, response, isSuccess);
                        
                        if (index === testCases.length - 1) {
                            setTimeout(() => {
                                updateStatus(`‚úÖ Test ho√†n th√†nh! ${successCount}/${totalCount} test th√†nh c√¥ng!`, 'success');
                            }, 500);
                        }
                    } catch (error) {
                        addTestResult(testCase, `L·ªói: ${error.message}`, false);
                    }
                }, index * 200);
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing Smart Chatbot Test...');
            
            try {
                // Initialize chatbot
                chatbot = new HaMienChatbot();
                chatbot.init();
                
                updateStatus('‚úÖ Chatbot ƒë√£ ƒë∆∞·ª£c kh·ªüi t·∫°o th√†nh c√¥ng!', 'success');
                
                // Auto run tests after 2 seconds
                setTimeout(() => {
                    updateStatus('üß™ ƒêang ch·∫°y test t·ª± ƒë·ªông...', 'success');
                    runSmartTests();
                }, 2000);
                
            } catch (error) {
                console.error('‚ùå Error initializing chatbot:', error);
                updateStatus(`‚ùå L·ªói: ${error.message}`, 'error');
            }
        });
    </script>
</body>
</html>



